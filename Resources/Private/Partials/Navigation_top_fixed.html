<!DOCTYPE html>
<!--
Copyright (C) 2020 PARAT Beteiligungs GmbH
Markus BlÃ¶chl <mbloechl@parat.eu>

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<!-- Top Navigation Fixed -->
<div id="top" class="header">
    <div class="headerline"></div>     
    <f:if condition="{bgimagewrap}!=''"> 
        <f:then>
            <nav id="mainnav" class="navbar navbar-expand-lg navbar-light fixed-top mainnav white">
        </f:then>
        <f:else>
            <nav id="mainnav" class="navbar navbar-expand-lg navbar-light fixed-top mainnav black">
        </f:else>
    </f:if>  
        <div class="container">  
            <a class="navbar-brand navbarbrandmain mb-2" title="Home" href="{baseUrltext}">
                <f:if condition="{bgimagewrap}!=''">
                    <f:then>
                        <f:cObject typoscriptObjectPath="obj.logo" />
                    </f:then>
                    <f:else>
                        <f:cObject typoscriptObjectPath="obj.logobl" />
                    </f:else>
                </f:if>
            </a>        
            <button id="navbutton" type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar" aria-label="Toggle Navigation">                
                <span class="navbar-toggler-icon"></span>               
            </button>        
            <div id="navbar" class="collapse navbar-collapse navbarcollapsemain">                
                <f:cObject typoscriptObjectPath="lib.navbar" />     
                <f:security.ifAuthenticated>
                    <f:then>
                        <f:comment><!-- logout --></f:comment>
                        <div id="logoutPlace"></div>
                    </f:then>
                    <f:else>
                        <f:comment><!-- login --></f:comment>
                        <div id="loginPlace"></div>
                    </f:else>
                </f:security.ifAuthenticated>
                
                <f:cObject typoscriptObjectPath="lib.languagebt" />
            </div>
        </div>
</div>

<script type="text/javascript">
    var controller = 'tx_pmbelayouts_pmbelayouts[controller]=Ajax';
    var actionN = 'tx_pmbelayouts_pmbelayouts[action]=loadLogin';
    var data = controller + '&' + actionN + '&' + 'type=528456';
    $.ajax({
        url: window.location.href,
        type: "GET",
        data: data,
        dataType: 'HTML',
        cache: false,
        success: function (result) {
            $("#loginPlace").html(result).fadeIn('fast');
        },
        error: function (jqXHR, textStatus, errorThrow) {
            $("#loginPlace").html('Ajax request - ' + textStatus + ': ' + errorThrow + jqXHR.responseText).fadeIn('fast');
        }
    });
    var actionLogout = 'tx_pmbelayouts_pmbelayouts[action]=loadLogout';
    var data = controller + '&' + actionLogout + '&' + 'type=528456';
    $.ajax({
        url: window.location.href,
        type: "GET",
        data: data,
        dataType: 'HTML',
        cache: false,
        success: function (result) {
            $("#logoutPlace").html(result).fadeIn('fast');
        },
        error: function (jqXHR, textStatus, errorThrow) {
            $("#logoutPlace").html('Ajax request - ' + textStatus + ': ' + errorThrow + jqXHR.responseText).fadeIn('fast');
        }
    });
</script>